<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Pixel Slots</title>
    <link rel="stylesheet" href="style.css">
    
    <!-- Telegram WebApp -->
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    
    <!-- Firebase SDK -->
    <script type="module">
        // Import the functions you need from the SDKs you need
        import { initializeApp } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js";
        import { getDatabase } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-database.js";
        import { getAnalytics } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-analytics.js";
        import { firebaseConfig } from "./firebase-config.js";

        // Initialize Firebase
        const app = initializeApp(firebaseConfig);
        const database = getDatabase(app);
        const analytics = getAnalytics(app);

        // Make Firebase available globally
        window.firebaseApp = app;
        window.firebaseDatabase = database;
        window.firebaseAnalytics = analytics;
    </script>
</head>
<body>
    <div id="game-container">
        <div id="game-header">
            <div id="balance-container">
                <span>Balance:</span>
                <span id="balance">$0.00</span>
            </div>
            <div id="jackpot-container">
                <span>Jackpot:</span>
                <span id="jackpot">$0.00</span>
            </div>
        </div>

        <div id="slot-machine">
            <div class="reel"><div class="symbol">🎰</div></div>
            <div class="reel"><div class="symbol">🎰</div></div>
            <div class="reel"><div class="symbol">🎰</div></div>
        </div>

        <div id="controls">
            <div id="bet-controls">
                <button id="decrease-bet">-</button>
                <span id="current-bet">$0.10</span>
                <button id="increase-bet">+</button>
            </div>
            <button id="max-bet">MAX BET</button>
            <button id="spin-button">SPIN</button>
            <button id="auto-play">AUTO</button>
        </div>

        <div id="win-table">
            <div class="win-row">
                <span>🎰 🎰 🎰</span>
                <span>JACKPOT</span>
            </div>
            <div class="win-row">
                <span>7️⃣ 7️⃣ 7️⃣</span>
                <span>x20</span>
            </div>
            <div class="win-row">
                <span>💎 💎 💎</span>
                <span>x10</span>
            </div>
            <div class="win-row">
                <span>🍊 🍊 🍊</span>
                <span>x4</span>
            </div>
            <div class="win-row">
                <span>🍋 🍋 🍋</span>
                <span>x3</span>
            </div>
            <div class="win-row">
                <span>🍒 🍒 🍒</span>
                <span>x2</span>
            </div>
        </div>
    </div>

    <div id="win-overlay" style="display: none;">
        <div id="win-content">
            <h2>YOU WIN!</h2>
            <p id="win-amount">$0.00</p>
            <button id="collect-win">COLLECT</button>
        </div>
    </div>

    <script>
        // Initialize Telegram WebApp
        window.Telegram.WebApp.ready();
    </script>
    <script type="module" src="game.js"></script>
    <script>
        // Wait for Telegram WebApp to be ready
        window.addEventListener('load', () => {
            if (!window.Telegram || !window.Telegram.WebApp) {
                console.error('Please open in Telegram!');
                alert('Please open this game in Telegram!');
                return;
            }

            // Log Telegram data
            console.log('=== TELEGRAM INIT ===');
            console.log('WebApp:', window.Telegram.WebApp);
            console.log('User:', window.Telegram.WebApp.initDataUnsafe?.user);

            // Initialize game
            window.game = new PixelSlots();
        });
    </script>
</body>
</html>
